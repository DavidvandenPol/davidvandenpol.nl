name: Build and deploy
on:
    push:
        branches: [main]
    workflow_dispatch:

jobs:
    build:
        name: ğŸ”¨ Building static site
        runs-on: ubuntu-latest
        steps:
            - name: âœ… Checkout repository
              uses: actions/checkout@main
            - name: ğŸ“ Install dependencies
              run: npm ci
            - name: ğŸ”¨ Build dependencies
              run: npm run build
            - name: ğŸ“š Archive production artifact
              uses: actions/upload-artifact@main
              with:
                  name: dist
                  path: dist
    deploy:
        name: Deploy ğŸš€
        needs: build
        runs-on: ubuntu-latest
        steps:
            - name: âœ… Checkout repository
              uses: actions/checkout@main
            - name: ğŸ”± Download artifact
              uses: actions/download-artifact@main
              with:
                  name: dist
                  path: dist
            - name: ğŸ“‚ Sync files
              uses: SamKirkland/FTP-Deploy-Action@4.3.3
              with:
                  server: ftp.strato.com
                  username: 512259297.swh.strato-hosting.eu
                  password: ${{ secrets.FTP_PASSWORD }}
